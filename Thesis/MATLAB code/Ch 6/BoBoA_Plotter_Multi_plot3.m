clc
clear

plot3(0, 0, 0, 'Color', [1 1 1])
hold on

EQ_Points_x = [0.004601; 0.002288; 0.002063; 0.00202; 0.002009];
EQ_Points_y = [42.45;       11.74;       5.073;       2.341;     0.5915];
EQ_Points_z = [40; 5; 3; 2; 1];
EQ_Points_Color = [.5 0 .2;
                                      1 0 0;
                                      1 .5 0;
                                      0 1 0;
                                      .5 0 1];
for i = 1:5
    EQ_Points(i) = plot3(EQ_Points_x(i), EQ_Points_y(i), EQ_Points_z(i), '*', 'Color', EQ_Points_Color(i, :));
end

% Draw Box
NOA = plot3([0 0], [0 50], [0 0], '--');
plot3([.005 .005], [0 50], [0 0], '--')
plot3([0 .005], [0 0], [0 0], '--')
plot3([0 .005], [50 50], [0 0], '--')

plot3([0 0], [0 50], [40 40], '--');
plot3([.005 .005], [0 50], [40 40], '--')
plot3([0 .005], [0 0], [40 40], '--')
plot3([0 .005], [50 50], [40 40], '--')

plot3([0 0], [0 0], [1 40], '--');
plot3([.005 .005], [50 50], [1 40], '--')
plot3([.005 .005], [0 0], [1 40], '--')
plot3([0 0], [50 50], [1 40], '--')

x = [-0.003; -0.002; -0.0003; -0.0002; -0.0001; 10^-20; 0.0001; 0.002; 0.003];
y = [-44.5, -44.5, -44.5, -44.5, -44.5, -44.5, -44.5, -44.5, -44.5;
        -86.5, -86.5, -86.5, -86.5, -86.5, -86.5, -86.5, -86.5, -86.5;
        -113.5, -113.5, -115.5, -115.5, -115.5, -116.5, -116.5,  -116.5, -116.5;
        -37.5, -37.5, -63.5, -97.5, -142.5, -142.5, -142.5, -142.5, -142.5;
        -6.5, -6.5, -13.5, -18.5, -36.5, -183.5, -183.5, -184.5, -184.5];

for i = 1:5
    plot3(x, y(i, :), EQ_Points_z(i)*[1; 1; 1; 1; 1; 1; 1; 1; 1], 'O', 'Color', EQ_Points_Color(i, :));
    BoBoA(i) = plot3(x, y(i, :), EQ_Points_z(i)*[1; 1; 1; 1; 1; 1; 1; 1; 1], 'LineWidth', 1, 'Color', EQ_Points_Color(i, :));
end

axis([-.004 .005 -200 60])

title(['Equilibrium Points and Their Basins of Attraction']);
xlabel('m_a [kg]')
ylabel('\omega_e [rad/s]')
zlabel('\alpha [deg]')
legend([NOA], 'Normal Operating Area', 'Location', 'Best');